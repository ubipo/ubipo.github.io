<html>
<head>
  <title></title>
  <meta content="">
  <meta charset="UTF-8"> 

<style>
  body {
    margin: 0;
  }

  #overviewTilesCont {
    width: 100vw;
    height: 100vh;
    display: flex;
    flex-wrap: wrap;
    filter: grayscale(0%);
  }

  #overviewTilesCont > div {
    min-width: 20rem;
    max-width: 50rem;
    flex-grow: 1;
    filter: inherit;
  }

  #detailTilesCont {
    position: fixed;
    top: 0;
    left: 0;
  }

  #detailTilesCont > div {
    position: absolute;
    display: none;
  }

  @keyframes aSelect-keyframes {
    from {
      opacity: 0;
    } to {
      opacity: 0.8;
      left: 0;
      top: 0;
      width: 100vw;
      height: 100vh;
    }
  }

  .aSelect {
    animation-name: aSelect-keyframes;
    animation-duration: 0.5s;
    animation-fill-mode: forwards;
  }

  .aDeSelect {
    animation-name: aSelect-keyframes;
    animation-duration: 0.5s;
    animation-direction: reverse;
    animation-fill-mode: backwards;
  }

  @keyframes aGrayout-keyframes {
    from {
      filter: grayscale(0%);
    } to {
      filter: grayscale(100%);
    }
  }

  .aGrayout {
    animation-name: aGrayout-keyframes;
    animation-duration: 0.5s;
    animation-fill-mode: forwards;
  }

  .aDeGrayout {
    animation-name: aGrayout-keyframes;
    animation-duration: 0.5s;
    animation-direction: reverse;
    animation-fill-mode: backwards;
  }

</style>
<script type="text/javascript">

/* From Modernizr */
function whichTransitionEvent(){
    var t;
    var el = document.createElement('fakeelement');
    var transitions = {
      'transition':'transitionend',
      'OTransition':'oTransitionEnd',
      'MozTransition':'transitionend',
      'WebkitTransition':'webkitTransitionEnd'
    }

    for(t in transitions){
        if( el.style[t] !== undefined ){
            return transitions[t];
        }
    }
}

/* Listen for a transition! */
var transitionEvent = whichTransitionEvent();

  var tiles = [
    {
      color: "#0b5563",
      name: "a"
    },
    {
      color: "#417b5a",
      name: "b"
    },
    {
      color: "#13293d",
      name: "c"
    },
    {
      color: "#eca400",
      name: "d"
    },
    {
      color: "#546a7b",
      name: "e"
    },
    {
      color: "#69140e",
      name: "f"
    }
  ]

  window.addEventListener("load", e => {
    var eOverviewTilesCont = document.querySelector("#overviewTilesCont");
    var eDetailTilesCont = document.querySelector("#detailTilesCont");

    for (let i = 0; i < tiles.length; i++) {
      let tile = tiles[i];

      // Create overview tile elem
      let eOverviewTile = document.createElement("div");
      eOverviewTile.style["background-color"] = tile.color;
      eOverviewTile.textContent = tile.name;
      eOverviewTilesCont.appendChild(eOverviewTile);

      // Create detail tile elem
      let eDetailTile = document.createElement("div");
      eDetailTile.style["background-color"] = tile.color;
      eDetailTilesCont.appendChild(eDetailTile);

      // Add listeners
      eOverviewTile.addEventListener("click", e => {
        var boundingRect = eOverviewTile.getBoundingClientRect();
        var w = boundingRect.right - boundingRect.left;
        var h = boundingRect.bottom - boundingRect.top;
        eDetailTile.style["top"] = boundingRect.top;
        eDetailTile.style["left"] = boundingRect.left;
        eDetailTile.style["width"] = String(w + "px");
        eDetailTile.style["height"] = String(h + "px");
        eDetailTile.style["display"] = "block";
        eDetailTile.classList.remove("aDeSelect");
        void eDetailTile.offsetWidth;
        eDetailTile.classList.add("aSelect");
      });

      eDetailTile.addEventListener("click", e => {
        eDetailTile.setAttribute('hide-after-animation', '');
        eDetailTile.classList.remove("aSelect");
        void eDetailTile.offsetWidth;
        eDetailTile.classList.add("aDeSelect");
      });

      eDetailTile.addEventListener('animationend', e => {
        if (eDetailTile.hasAttribute('hide-after-animation')) {
          eDetailTile.removeAttribute('hide-after-animation');
          eDetailTile.style['display'] = 'none';
        }
      }, false);
    }
  });



  // .forEach(e => e.addEventListener("click", e => {
  //   var tile = e.target;
  //   var detail = document.querySelector("#a-detail");
  //   var rect = tile.getBoundingClientRect();
  //   var w = rect.right - rect.left;
  //   var h = rect.bottom - rect.top;
  //   detail.style["top"] = rect.top;
  //   detail.style["left"] = rect.left;
  //   detail.style["width"] = String(w + "px");
  //   detail.style["height"] = String(h + "px");
  //   detail.style["display"] = "block";
  //   detail.classList.add("select-animation");
  //   // console.log(rect.top, rect.right, rect.bottom, rect.left);
  //   // e.preventDefault;
  //   // e.target.classList.remove("select-animation");
  //   // void e.target.offsetWidth;
  //   // e.target.classList.add("select-animation");
  // });
</script>

</head>

<body>
  <section id="overviewTilesCont"></section>
  <section id="detailTilesCont"></section>
</body>

</html>